

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Hyperspectral Images &mdash; USID 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "document", "processHtmlClass": "math|output_area"}}</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Video" href="video.html" />
    <link rel="prev" title="3D Spectral Image" href="spectral_image.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> USID
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">USID</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">Universal Spectroscopy and Imaging Data  (USID)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../motivation.html">Motivation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nomenclature.html">Nomenclature</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usid_model.html">Data Schema</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../file_format.html">File Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../h5_usid.html">USID in HDF5</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../metadata.html">Metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced_topics.html">Advanced topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Frequently asked questions</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="spectrum.html">1D Spectrum or Curve</a></li>
<li class="toctree-l2"><a class="reference internal" href="image.html">2D Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="spectral_image.html">3D Spectral Image</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Hyperspectral Images</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Prerequisites:">Prerequisites:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Import-all-necessary-packages">Import all necessary packages</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Download-the-dataset">Download the dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Open-the-file">Open the file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Visualize-the-contents-in-each-of-these-channels">Visualize the contents in each of these channels</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Sharing-Ancillary-Datasets">Sharing Ancillary Datasets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Visualizing-the-contents-within-each-channel">Visualizing the contents within each channel</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Clean-up">Clean up</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="video.html">Video</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">USID</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Examples</a> &raquo;</li>
        
      <li>Hyperspectral Images</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/notebooks/examples/image_stack.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Hyperspectral-Images">
<h1>Hyperspectral Images<a class="headerlink" href="#Hyperspectral-Images" title="Permalink to this headline">¶</a></h1>
<p>(Simultaneously acquired 2D images)</p>
<p><strong>Suhas Somnath</strong></p>
<p>10/12/2018</p>
<p><strong>This example illustrates how a set of simultaneously acquired 2D grayscale images would be represented in the Universal Spectroscopy and Imaging Data (USID) schema and stored in a Hierarchical Data Format (HDF5) file, also referred to as the h5USID file.</strong> This example is based on the popular Atomic Force Microscopy scan mode where multiple sensors <em>simultaneously</em> acquire a value at each position on a 2D grid, thereby resulting in a 2D image per sensor. Specifically, the goal of this example
is to demonstrate the sharing of <code class="docutils literal notranslate"><span class="pre">Ancillary</span></code> datasets among multiple <code class="docutils literal notranslate"><span class="pre">Main</span></code> datasets.</p>
<p>This document is intended as a supplement to the explanation about the <a class="reference external" href="../../usid_model.html">USID model</a></p>
<p>Please consider downloading this document as a Jupyter notebook using the button at the bottom of this document.</p>
<div class="section" id="Prerequisites:">
<h2>Prerequisites:<a class="headerlink" href="#Prerequisites:" title="Permalink to this headline">¶</a></h2>
<p>We recommend that you read about the <a class="reference external" href="../../usid_model.html">USID model</a></p>
<p>We will be making use of the <code class="docutils literal notranslate"><span class="pre">pyUSID</span></code> package at multiple places to illustrate the central point. While it is recommended / a bonus, it is not absolutely necessary that the reader understands how the specific <code class="docutils literal notranslate"><span class="pre">pyUSID</span></code> functions work or why they were used in order to understand the data representation itself. Examples about these functions can be found in other documentation on pyUSID and the reader is encouraged to read the supplementary documents.</p>
<div class="section" id="Import-all-necessary-packages">
<h3>Import all necessary packages<a class="headerlink" href="#Import-all-necessary-packages" title="Permalink to this headline">¶</a></h3>
<p>The main packages necessary for this example are <code class="docutils literal notranslate"><span class="pre">h5py</span></code>, <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>, and <code class="docutils literal notranslate"><span class="pre">sidpy</span></code>, in addition to <code class="docutils literal notranslate"><span class="pre">pyUSID</span></code>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">warnings</span> <span class="kn">import</span> <span class="n">warn</span>
<span class="kn">import</span> <span class="nn">h5py</span>

<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="k">def</span> <span class="nf">install</span><span class="p">(</span><span class="n">package</span><span class="p">):</span>
    <span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">([</span><span class="n">sys</span><span class="o">.</span><span class="n">executable</span><span class="p">,</span> <span class="s2">&quot;-m&quot;</span><span class="p">,</span> <span class="s2">&quot;pip&quot;</span><span class="p">,</span> <span class="s2">&quot;install&quot;</span><span class="p">,</span> <span class="n">package</span><span class="p">])</span>


<span class="k">try</span><span class="p">:</span>
    <span class="c1"># This package is not part of anaconda and may need to be installed.</span>
    <span class="kn">import</span> <span class="nn">wget</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="n">warn</span><span class="p">(</span><span class="s1">&#39;wget not found.  Will install with pip.&#39;</span><span class="p">)</span>
    <span class="kn">import</span> <span class="nn">pip</span>
    <span class="n">install</span><span class="p">(</span><span class="s1">&#39;wget&#39;</span><span class="p">)</span>
    <span class="kn">import</span> <span class="nn">wget</span>

<span class="c1"># Finally import pyUSID.</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">pyUSID</span> <span class="k">as</span> <span class="nn">usid</span>
    <span class="kn">import</span> <span class="nn">sidpy</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="n">warn</span><span class="p">(</span><span class="s1">&#39;pyUSID not found.  Will install with pip.&#39;</span><span class="p">)</span>
    <span class="kn">import</span> <span class="nn">pip</span>
    <span class="n">install</span><span class="p">(</span><span class="s1">&#39;pyUSID&#39;</span><span class="p">)</span>
    <span class="kn">import</span> <span class="nn">sidpy</span>
    <span class="kn">import</span> <span class="nn">pyUSID</span> <span class="k">as</span> <span class="nn">usid</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Download-the-dataset">
<h2>Download the dataset<a class="headerlink" href="#Download-the-dataset" title="Permalink to this headline">¶</a></h2>
<p>As mentioned earlier, this image is available on the USID repository and can be accessed directly as well. Here, we will simply download the file using <code class="docutils literal notranslate"><span class="pre">wget</span></code>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">h5_path</span> <span class="o">=</span> <span class="s1">&#39;temp.h5&#39;</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/pycroscopy/USID/master/data/SingFreqPFM_0003.h5&#39;</span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">h5_path</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">h5_path</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">wget</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">h5_path</span><span class="p">,</span> <span class="n">bar</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Open-the-file">
<h2>Open the file<a class="headerlink" href="#Open-the-file" title="Permalink to this headline">¶</a></h2>
<p>Lets open the file and look at its contents using <a class="reference external" href="https://pycroscopy.github.io/sidpy/notebooks/03_hdf5/hdf_utils_read.html#print_tree()">sidpy.hdf_utils.print_tree()</a></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">h5_file</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">h5_path</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">usid</span><span class="o">.</span><span class="n">hdf_utils</span><span class="o">.</span><span class="n">print_tree</span><span class="p">(</span><span class="n">h5_file</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
/
├ Measurement_000
  ---------------
  ├ Channel_000
    -----------
    ├ Raw_Data
  ├ Channel_001
    -----------
    ├ Raw_Data
  ├ Channel_002
    -----------
    ├ Raw_Data
  ├ Channel_003
    -----------
    ├ Raw_Data
  ├ Position_Indices
  ├ Position_Values
  ├ Spectroscopic_Indices
  ├ Spectroscopic_Values
</pre></div></div>
</div>
<p>Notice that this file has multiple <a class="reference external" href="../../usid_model.html#channels">Channel</a>, each with a dataset named <code class="docutils literal notranslate"><span class="pre">Raw_Data</span></code>. Are they all <a class="reference external" href="../../usid_model.html#main-datasets">Main Dataset</a> datasets? There are multiple ways to find out this. One approach is simply to ask pyUSID to list out all available <code class="docutils literal notranslate"><span class="pre">Main</span></code> datasets.</p>
</div>
<div class="section" id="Visualize-the-contents-in-each-of-these-channels">
<h2>Visualize the contents in each of these channels<a class="headerlink" href="#Visualize-the-contents-in-each-of-these-channels" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">main_dset</span> <span class="ow">in</span> <span class="n">usid</span><span class="o">.</span><span class="n">hdf_utils</span><span class="o">.</span><span class="n">get_all_main</span><span class="p">(</span><span class="n">h5_file</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">main_dset</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---------------------------------------------------------------</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;HDF5 dataset &#34;Raw_Data&#34;: shape (16384, 1), type &#34;&lt;f4&#34;&gt;
located at:
        /Measurement_000/Channel_000/Raw_Data
Data contains:
        HeightRetrace (m)
Data dimensions and original shape:
Position Dimensions:
        X - size: 128
        Y - size: 128
Spectroscopic Dimensions:
        arb - size: 1
Data Type:
        float32
---------------------------------------------------------------

&lt;HDF5 dataset &#34;Raw_Data&#34;: shape (16384, 1), type &#34;&lt;f4&#34;&gt;
located at:
        /Measurement_000/Channel_001/Raw_Data
Data contains:
        AmplitudeRetrace (m)
Data dimensions and original shape:
Position Dimensions:
        X - size: 128
        Y - size: 128
Spectroscopic Dimensions:
        arb - size: 1
Data Type:
        float32
---------------------------------------------------------------

&lt;HDF5 dataset &#34;Raw_Data&#34;: shape (16384, 1), type &#34;&lt;f4&#34;&gt;
located at:
        /Measurement_000/Channel_002/Raw_Data
Data contains:
        DeflectionRetrace (m)
Data dimensions and original shape:
Position Dimensions:
        X - size: 128
        Y - size: 128
Spectroscopic Dimensions:
        arb - size: 1
Data Type:
        float32
---------------------------------------------------------------

&lt;HDF5 dataset &#34;Raw_Data&#34;: shape (16384, 1), type &#34;&lt;f4&#34;&gt;
located at:
        /Measurement_000/Channel_003/Raw_Data
Data contains:
        PhaseRetrace (m)
Data dimensions and original shape:
Position Dimensions:
        X - size: 128
        Y - size: 128
Spectroscopic Dimensions:
        arb - size: 1
Data Type:
        float32
---------------------------------------------------------------

</pre></div></div>
</div>
<p>From the print statements above, it is clear that each of these <code class="docutils literal notranslate"><span class="pre">Raw_Data</span></code> datasets were indeed <code class="docutils literal notranslate"><span class="pre">Main</span></code> datasets. How can these datasets be <code class="docutils literal notranslate"><span class="pre">Main</span></code> if they are not co-located with the corresponding sets of <code class="docutils literal notranslate"><span class="pre">Ancillary</span></code> datasets within each <code class="docutils literal notranslate"><span class="pre">Channel</span></code> group?</p>
</div>
<div class="section" id="Sharing-Ancillary-Datasets">
<h2>Sharing Ancillary Datasets<a class="headerlink" href="#Sharing-Ancillary-Datasets" title="Permalink to this headline">¶</a></h2>
<p>Since each of the <code class="docutils literal notranslate"><span class="pre">Main</span></code> datasets have the same position and spectroscopic dimensions, they share the same set of ancillary datasets that are under <code class="docutils literal notranslate"><span class="pre">Measurement_000</span></code> group. This is common for Scanning Probe Microscopy scans where information from multiple sensors are recorded <strong>simultaneously</strong> during the scan.</p>
<p>Recall from the USID documentation that:</p>
<ol class="arabic simple">
<li><p>Multiple <code class="docutils literal notranslate"><span class="pre">Main</span></code> datasets can share the same <code class="docutils literal notranslate"><span class="pre">Ancillary</span></code> datasets</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">Main</span></code> datasets only need to have <code class="docutils literal notranslate"><span class="pre">attributes</span></code> named <code class="docutils literal notranslate"><span class="pre">Position_Indices</span></code>, <code class="docutils literal notranslate"><span class="pre">Position_Values</span></code>, <code class="docutils literal notranslate"><span class="pre">Spectroscopic_Indices</span></code>, and <code class="docutils literal notranslate"><span class="pre">Spectroscopic_Values</span></code>with the value set to the reference of the corresponding <code class="docutils literal notranslate"><span class="pre">Ancillary</span></code> datasets</p></li>
</ol>
<p>We can investigate if this is indeed the case here. Lets get the references to <code class="docutils literal notranslate"><span class="pre">Ancillary</span></code> datasets linked to each of the <code class="docutils literal notranslate"><span class="pre">Main</span></code> datasets:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">main_dset</span> <span class="ow">in</span> <span class="n">usid</span><span class="o">.</span><span class="n">hdf_utils</span><span class="o">.</span><span class="n">get_all_main</span><span class="p">(</span><span class="n">h5_file</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Main Dataset: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">main_dset</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Position Indices: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">main_dset</span><span class="o">.</span><span class="n">h5_pos_inds</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Position Values: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">main_dset</span><span class="o">.</span><span class="n">h5_pos_vals</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Spectroscopic Indices: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">main_dset</span><span class="o">.</span><span class="n">h5_spec_inds</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Spectroscopic Values: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">main_dset</span><span class="o">.</span><span class="n">h5_spec_vals</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---------------------------------------------------------------</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Main Dataset: /Measurement_000/Channel_000/Raw_Data
Position Indices: /Measurement_000/Position_Indices
Position Values: /Measurement_000/Position_Values
Spectroscopic Indices: /Measurement_000/Spectroscopic_Indices
Spectroscopic Values: /Measurement_000/Spectroscopic_Values
---------------------------------------------------------------

Main Dataset: /Measurement_000/Channel_001/Raw_Data
Position Indices: /Measurement_000/Position_Indices
Position Values: /Measurement_000/Position_Values
Spectroscopic Indices: /Measurement_000/Spectroscopic_Indices
Spectroscopic Values: /Measurement_000/Spectroscopic_Values
---------------------------------------------------------------

Main Dataset: /Measurement_000/Channel_002/Raw_Data
Position Indices: /Measurement_000/Position_Indices
Position Values: /Measurement_000/Position_Values
Spectroscopic Indices: /Measurement_000/Spectroscopic_Indices
Spectroscopic Values: /Measurement_000/Spectroscopic_Values
---------------------------------------------------------------

Main Dataset: /Measurement_000/Channel_003/Raw_Data
Position Indices: /Measurement_000/Position_Indices
Position Values: /Measurement_000/Position_Values
Spectroscopic Indices: /Measurement_000/Spectroscopic_Indices
Spectroscopic Values: /Measurement_000/Spectroscopic_Values
---------------------------------------------------------------

</pre></div></div>
</div>
<p>From above, we see that all the <code class="docutils literal notranslate"><span class="pre">Main</span></code> datasets we indeed referencing the same set of <code class="docutils literal notranslate"><span class="pre">Ancillary</span></code> Datasets. Note that it would <strong>not</strong> have been wrong to store (duplicate copies of) the <code class="docutils literal notranslate"><span class="pre">Ancillary</span></code> datasets within each <code class="docutils literal notranslate"><span class="pre">Channel</span></code> group. The data was stored in this manner since it is more efficient and because it was known <em>apriori</em> that all <code class="docutils literal notranslate"><span class="pre">Main</span></code> datasets are dimensionally equal. Also note that this sharing of <code class="docutils literal notranslate"><span class="pre">Ancillary</span></code> datasets is OK even though the physical quantity and units
within each <code class="docutils literal notranslate"><span class="pre">Main</span></code> dataset are different since these two pieces of information are stored in the attributes of the <code class="docutils literal notranslate"><span class="pre">Main</span></code> datasets (which are unique and independent) and not in the <code class="docutils literal notranslate"><span class="pre">Ancillary</span></code> datasets.</p>
<p>The discussion regarding the contents of the <code class="docutils literal notranslate"><span class="pre">Ancillary</span></code> datasets are identical to that for the <a class="reference external" href="./image.html">2D grayscale image</a> and will not be discussed here for brevity.</p>
</div>
<div class="section" id="Visualizing-the-contents-within-each-channel">
<h2>Visualizing the contents within each channel<a class="headerlink" href="#Visualizing-the-contents-within-each-channel" title="Permalink to this headline">¶</a></h2>
<p>Now lets visualize the contents within this <code class="docutils literal notranslate"><span class="pre">Main</span> <span class="pre">Dataset</span></code> using the <code class="docutils literal notranslate"><span class="pre">USIDataset's</span></code> built-in <a class="reference external" href="../user_guide/usi_dataset.html#Interactive-Visualization">visualize()</a> function.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">usid</span><span class="o">.</span><span class="n">plot_utils</span><span class="o">.</span><span class="n">use_nice_plot_params</span><span class="p">()</span>
<span class="k">for</span> <span class="n">main_dset</span> <span class="ow">in</span> <span class="n">usid</span><span class="o">.</span><span class="n">hdf_utils</span><span class="o">.</span><span class="n">get_all_main</span><span class="p">(</span><span class="n">h5_file</span><span class="p">):</span>
    <span class="n">main_dset</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">num_ticks</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_examples_image_stack_11_0.png" src="../../_images/notebooks_examples_image_stack_11_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_examples_image_stack_11_1.png" src="../../_images/notebooks_examples_image_stack_11_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_examples_image_stack_11_2.png" src="../../_images/notebooks_examples_image_stack_11_2.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_examples_image_stack_11_3.png" src="../../_images/notebooks_examples_image_stack_11_3.png" />
</div>
</div>
</div>
<div class="section" id="Clean-up">
<h2>Clean up<a class="headerlink" href="#Clean-up" title="Permalink to this headline">¶</a></h2>
<p>Finally lets close and delete the example HDF5 file</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">h5_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">h5_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="video.html" class="btn btn-neutral float-right" title="Video" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="spectral_image.html" class="btn btn-neutral float-left" title="3D Spectral Image" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2018, Stephen Jesse, Suhas Somnath and Chris Smith.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>